---
title: "クロスアカウントでReadOnlyのアクセス権を与えるハンズオン"
emoji: "🐕"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [AWS]
published: true
---



1. **はじめに**
   - AWS IAMとは
   AWS Identity and Access Management（IAM）は、AWSのリソースへのアクセスを安全に制御するためのサービスです。IAMを使用すると、どのユーザーがどのAWSリソースに対してどのような操作を行うことができるかを詳細に制御できます。

   - クロスアカウントアクセスとは
   クロスアカウントアクセスとは、あるAWSアカウントのIAMユーザーやロールが、別のAWSアカウントのリソースにアクセスすることを指します。これは、大企業のように複数のAWSアカウントを持っている組織や、AWSリソースを共有する必要があるパートナーシップを持つ組織にとって非常に重要な機能です。

   - ユースケース
   開発チームと運用チームがそれぞれ異なるAWSアカウントを使用している場合、開発チームの一部のメンバーが一時的に運用チームのAWSリソースにアクセスする必要があるかもしれません。このようなケースでは、IAMのクロスアカウントアクセス機能を使用して、必要なメンバーに一時的にアクセス権限を付与することができます。

   - この記事の目的と成果物についての説明
   クロスアカウントでReadOnlyのアクセス権を与えるハンズオンの説明

2. **前提条件**
   - AWSアカウント2つが必要であること
     アカウントA：Iamロールを作成、IamロールにReadOnlyポリシーを付与
     アカウントB：アカウントAにスイッチする
   - 基本的なAWSとIAMの知識があること
   - ブラウザを2つ用意（Chrome,Edgeを使用）

3. **ステップ1: アカウントAのマネジメントコンソールにアクセスする**

    マネジメントコンソールを開き、サービスメニューからIAMを開きます。(Chromeを使用しています。)
    ![](/images/922c8091e6d11f/E8025BDE-EA61-46C3-A03A-555383C7D96B.jpeg)

4. **ステップ2: IAMロールの作成**
   - IAMロール作成のための左のメニューから「ロール」をクリックして右上の「ロールを作成」をクリックします。
    ![](/images/922c8091e6d11f/76342BA5-2B87-49D2-97B4-18390A61E10A.jpeg)

   - 信頼されたエンティティタイプ
   今回はBのAWSアカウントからアクセスを許可するので「AWSアカウント」を選択します。
   - AWSアカウント
   別のAWSアカウントを選択してアカウントBのアカウントIDを入力します。

    ![](/images/922c8091e6d11f/AF71134E-CAD7-4EA1-86EA-5C7A8A1B8D4B.jpeg)


   - ReadOnlyのポリシーを付与するので、検索欄に「ReadOnly」と入力しEnterを押します。
   ReadOnlyのポリシーが先頭に来るので、左のチェックボックスをクリックします。
   チェックがついたら右下の「次へ」をクリックします。
    ![](/images/922c8091e6d11f/A9595253-1F7B-44AC-83F9-568F1EB3EB4F.jpeg)
    ![](/images/922c8091e6d11f/BBFA7C6F-B3ED-4BDD-BF9C-BCA95FACADA5.jpeg)

   - ロール名と説明に「readonly-role」と入力し信頼されたエンティティにアカウントBのIDの値が正しいか確認します。
   問題なければ右下の「ロールを作成」をクリックします。
    ![](/images/922c8091e6d11f/2A4C262E-4261-465A-B552-1F6DF554C956.jpeg)

    ```
    {
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Principal": {
                "AWS": "のアカウントBのID"
            },
            "Condition": {}
        }
       ]
     }
   ```


    ![](/images/922c8091e6d11f/3E7FBEA0-F194-4E00-A163-45972759A05F.jpeg)

   - ロールが作成されるとページの上に緑色の枠のメッセージで確認できます。

    ![](/images/922c8091e6d11f/4BCB04C8-F3B6-4E76-9643-0683389E7310.jpeg)

    - 作成した「readonly-role」を検索します。「readonly-role」が表示されたらクリックします。

    ![](/images/922c8091e6d11f/2D1313D8-237E-44CA-BAD6-9F9539954173_4_5005_c.jpeg)

    - コンソールでロールを切り替えるためのリンクのアイコンをクリックします。
    リンクがコピーされます。
    ![](/images/922c8091e6d11f/00E36C73-54E6-4AB9-95DC-D225393C2D60.jpeg)

   - クロスアカウントアクセスのために信頼ポリシーを設定する方法

5. **ステップ3: アクセスのテスト**
   - EdgeのブラウザからBのAWSアカウントにログインします。
    ![](/images/922c8091e6d11f/F821A8EA-C5E3-46EB-83AF-C658453B2E1B.jpeg)

   - Edgeの新しいタブを開き先ほどコピーしたリンクにアクセします。
   ロールの切り替え画面が表示されます。
   （リンクからアクセスするとアカウントとロールの入力蘭は値が入っている状態です。）
   表示名に「readonly-role」と入力してください。色は適当に選択し「ロールの切り替え」をクリックします。
    ![](/images/922c8091e6d11f/A56A18BB-C6F2-441A-9BF2-3443B62936C1.jpeg)

   - マネージメントコンソールが開き右上のユーザーが「readonly-role」になっていることを確認してください。
    ![](/images/922c8091e6d11f/42A7D192-4DC2-4138-B695-29F1B892D0E6.jpeg)

   - 次回からはロールの履歴からアカウントAにスイッチロールすることができます。
    ![](/images/922c8091e6d11f/D2C12AD7-EF79-4D09-9FF2-DC87A8788884_4_5005_c.jpeg)

以上です。

6. **まとめ**
「ReadOnly」のIAMロールを作成し、他のAWSアカウントへのアクセスを設定する手順を学びました。クロスアカウントアクセスは開発環境間でのアクセス管理に重要で、異なるAWSアカウント間で作業を行う場合やアクセス権限を制限する場面で役立ちます。
一度スイッチロールしたアカウントは履歴からアクセスできるようになるので便利になります。
「クロスアカウント」や「スイッチロール」など、名前だけ聞くと難しそうに感じていましたが、実際に操作してみると簡単に設定することができました。


